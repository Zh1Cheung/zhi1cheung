---
title: MYSQL范式设计
categories:
- MYSQL
tags:
- MYSQL
---

## 数据表中的键

- 超键：能唯一标识元组的属性集叫做超键。 

- 候选键：如果超键不包括多余的属性，那么这个超键就是候选键。 
- 主键：用户可以从候选键中选择一个作为主键。 
- 外键：如果数据表 R1 中的某属性集不是 R1 的主键，而是另一个数据表 R2 的主键，那么这个属性集就是数据表 R1 的外键。 
- 主属性：包含在任一候选键中的属性称为主属性。 
- 非主属性：与主属性相对，指的是不包含在任何一个候选键中的属性。

- 把的球员表（player）定义为包含球员编号、姓名、身份证号、年龄和球队编号；球队表（team）包含球队编号、主教练和球队所在地。 

  - 对于球员表来说，超键就是包括球员编号或者身份证号的任意组合，比如（球员编号）（球 

    员编号，姓名）（身份证号，年龄）等。 

  - 候选键就是最小的超键，对于球员表来说，候选键就是（球员编号）或者（身份证号）。 

  - 主键是我们自己选定，也就是从候选键中选择一个，比如（球员编号）。 

  - 在 player 表中，主属性是（球员编号）（身份证号），其他的属性（姓名）（年龄）（球 

    队编号）都是非主属性。





## 从 1NF 到 3NF

- **1NF 指的是数据库表中的任何属性都是原子性的，不可再分**

  - 我们在设计某 个字段的时候，对于字段 X 来说，就不能把字段 X 拆分成字段 X-1 和字段 X-2。事实上，任何的 DBMS 都会满足第一范式的要求，不会将字段进行拆分。 

- **2NF 指的数据表里的非主属性都要和这个数据表的候选键有完全依赖关系**

  - (球员编号, 比赛编号) → (姓名, 年龄, 比赛时间, 比赛场地，得分)

  - 但是这个数据表不满足第二范式，因为数据表中的字段之间还存在着如下的对应关系

    - > (球员编号) → (姓名，年龄) 
      >
      > (比赛编号) → (比赛时间, 比赛场地)
      >
      > 
      >
      > 知道球员的编号是可以知道球员信息的，但是比赛编号、比赛时间是无法来通过球员信息来确定的。这张表需要两个候选码（球员编号、比赛编号）才能确定一条记录的信息。类似于这样的关系我们称为「部分依赖」,消除后才能算「第二范式」。

  - 这样会产生怎样的问题呢

    - 数据冗余：如果一个球员可以参加 m 场比赛，那么球员的姓名和年龄就重复了 m-1 次。一个比赛也可能会有 n 个球员参加，比赛的时间和地点就重复了 n-1 次。 
    - 插入异常：如果我们想要添加一场新的比赛，但是这时还没有确定参加的球员都有谁， 那么就没法插入。 
    - 删除异常：如果我要删除某个球员编号，如果没有单独保存比赛表的话，就会同时把比 赛信息删除掉。 
    - 更新异常：如果我们调整了某个比赛的时间，那么数据表中所有这个比赛的时间都需要 进行调整，否则就会出现一场比赛时间不同的情况。 

  - 为了避免出现上述的情况，我们可以把球员比赛表设计为下面的三张表

    - 球员 player 表包含球员编号、姓名和年龄等属性；比赛 game 表包含比赛编号、比赛时间 和比赛场地等属性；球员比赛关系 player_game 表包含球员编号、比赛编号和得分等属性。 

  - 某种程度上 2NF 是 对 1NF 原子性的升级。1NF 告诉我们字段属性需要是原子性的，而 2NF 告诉我们一张表就是一个独立的对象，也就是说一张表只表达一个意思。 

- **3NF 在满足 2NF 的同时，对任何非主属性都不传递依赖于候选键**

  - 也就是说不能存在非主属性 A 依赖于非主属性 B，非主属性 B 依赖于候选键的情况
    - 球员 player 表中球员编号决定了球队名称，同时球队名称决定了球队主教练，非主属性球队主教练就会传递依赖于球员编号，因此不符合 3NF 的要求。 
  - 如果要达到 3NF 的要求，需要把数据表拆成下面这样
    - 球员表的属性包括球员编号、姓名和球队名称；球队表的属性包括球队名称、球队主教练。

- **2NF和3NF都强调非主属性对主属性的依赖关系，2N针对完全依赖，3NF针对直接依赖，都是为了保持表的原子性。**







## **反范式设计**

- **BCNF，也叫做巴斯 - 科德范式，它在 3NF 的基础上消除了主属性对候选键的部分依赖或者传递依赖关系**

- 我们在之前已经了解了越高阶的范式得到的数据表越多，数据冗余度越低。但有时候，我们 

  在设计数据表的时候，还需要为了性能和读取效率违反范式化的原则。反范式就是相对范式 

  化而言的，换句话说，就是允许少量的冗余，通过空间来换时间。





